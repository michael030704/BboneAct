<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Management & Shopping App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.13.6/underscore-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.5.0/backbone-min.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --success: #4cc9f0;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --border: #dee2e6;
            --shadow: rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fb;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 12px var(--shadow);
            margin-bottom: 30px;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .tab-container {
            display: flex;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 12px var(--shadow);
            margin-bottom: 30px;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            background: white;
            border: none;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab:hover:not(.active) {
            background: var(--light-gray);
        }
        
        .tab-content {
            display: none;
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 12px var(--shadow);
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .section-title {
            font-size: 1.8rem;
            margin-bottom: 25px;
            color: var(--primary);
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-gray);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            transition: border 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .btn {
            padding: 12px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-danger {
            background: #e63946;
        }
        
        .btn-danger:hover {
            background: #d90429;
        }
        
        .btn-success {
            background: #2a9d8f;
        }
        
        .btn-success:hover {
            background: #21867a;
        }
        
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .product-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow);
        }
        
        .product-image {
            height: 200px;
            width: 100%;
            object-fit: cover;
            background: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
        }
        
        .product-info {
            padding: 20px;
        }
        
        .product-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .product-price {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
        }
        
        .product-description {
            color: var(--gray);
            margin-bottom: 15px;
            min-height: 60px;
        }
        
        .product-actions {
            display: flex;
            gap: 10px;
        }
        
        .clients-list {
            margin-top: 20px;
        }
        
        .client-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .client-info h3 {
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .client-details {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .cart-container {
            display: flex;
            gap: 30px;
        }
        
        .products-list {
            flex: 3;
        }
        
        .cart-summary {
            flex: 1;
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 12px var(--shadow);
            height: fit-content;
        }
        
        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .cart-item:last-child {
            border-bottom: none;
        }
        
        .cart-item-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            margin-right: 15px;
            background: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
        }
        
        .cart-item-info {
            flex: 1;
        }
        
        .cart-item-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: var(--primary);
            font-weight: 600;
        }
        
        .cart-item-quantity {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }
        
        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid var(--border);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quantity-value {
            margin: 0 10px;
            min-width: 20px;
            text-align: center;
        }
        
        .cart-total {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--light-gray);
            font-size: 1.2rem;
            font-weight: 700;
        }
        
        .empty-cart {
            text-align: center;
            padding: 40px 0;
            color: var(--gray);
        }
        
        .empty-cart i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--light-gray);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            background: var(--success);
            color: white;
            box-shadow: 0 5px 15px var(--shadow);
            transform: translateX(200%);
            transition: transform 0.4s ease;
            z-index: 1000;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.error {
            background: #e63946;
        }
        
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        @media (max-width: 768px) {
            .cart-container {
                flex-direction: column;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1><i class="fas fa-store"></i> Product Management & Shopping App</h1>
            <div id="current-date">November 22, 2025</div>
        </div>
    </header>
    
    <div class="container">
        <div class="tab-container">
            <button class="tab active" data-tab="products">Manage Products</button>
            <button class="tab" data-tab="clients">Manage Clients</button>
            <button class="tab" data-tab="shop">Shop Products</button>
        </div>
        
        <!-- Products Management Tab -->
        <div id="products-tab" class="tab-content active">
            <h2 class="section-title">Product Management</h2>
            
            <div class="form-group">
                <label for="product-name">Product Name</label>
                <input type="text" id="product-name" placeholder="Enter product name">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="product-price">Price ($)</label>
                    <input type="number" id="product-price" placeholder="Enter price" min="0" step="0.01">
                </div>
                
                <div class="form-group">
                    <label for="product-category">Category</label>
                    <select id="product-category">
                        <option value="">Select category</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Clothing">Clothing</option>
                        <option value="Home & Kitchen">Home & Kitchen</option>
                        <option value="Books">Books</option>
                        <option value="Toys">Toys</option>
                    </select>
                </div>
            </div>
            
            <div class="form-group">
                <label for="product-description">Description</label>
                <textarea id="product-description" rows="3" placeholder="Enter product description"></textarea>
            </div>
            
            <div class="form-group">
                <label for="product-image">Product Image</label>
                <input type="text" id="product-image" placeholder="Enter image URL">
            </div>
            
            <button id="add-product-btn" class="btn"><i class="fas fa-plus"></i> Add Product</button>
            
            <h3 style="margin: 30px 0 15px; color: var(--dark);">Product List</h3>
            <div id="products-container" class="products-grid">
                <!-- Products will be added here dynamically -->
            </div>
        </div>
        
        <!-- Clients Management Tab -->
        <div id="clients-tab" class="tab-content">
            <h2 class="section-title">Client Management</h2>
            
            <div class="form-group">
                <label for="client-name">Client Name</label>
                <input type="text" id="client-name" placeholder="Enter client name">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="client-card">Card Number</label>
                    <input type="text" id="client-card" placeholder="Enter card number (1234 5678 9012 3456)">
                </div>
                
                <div class="form-group">
                    <label for="client-cvv">CVV</label>
                    <input type="text" id="client-cvv" placeholder="Enter CVV (123)" maxlength="3">
                </div>
            </div>
            
            <div class="form-group">
                <label for="client-address">Address</label>
                <textarea id="client-address" rows="2" placeholder="Enter full address"></textarea>
            </div>
            
            <button id="add-client-btn" class="btn"><i class="fas fa-user-plus"></i> Add Client</button>
            
            <h3 style="margin: 30px 0 15px; color: var(--dark);">Client List</h3>
            <div id="clients-container" class="clients-list">
                <!-- Clients will be added here dynamically -->
            </div>
        </div>
        
        <!-- Shopping Tab -->
        <div id="shop-tab" class="tab-content">
            <h2 class="section-title">Shop Products</h2>
            
            <div class="cart-container">
                <div class="products-list">
                    <div id="shop-products-container" class="products-grid">
                        <!-- Products will be added here dynamically -->
                    </div>
                </div>
                
                <div class="cart-summary">
                    <h3>Your Cart</h3>
                    <div id="cart-items">
                        <!-- Cart items will be added here dynamically -->
                    </div>
                    
                    <div id="empty-cart-message" class="empty-cart">
                        <i class="fas fa-shopping-cart"></i>
                        <p>Your cart is empty</p>
                    </div>
                    
                    <div class="cart-total">
                        Total: $<span id="cart-total-amount">0.00</span>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <label for="client-select">Select Client</label>
                        <select id="client-select">
                            <option value="">Choose a client</option>
                            <!-- Clients will be populated here -->
                        </select>
                    </div>
                    
                    <button id="checkout-btn" class="btn" style="margin-top: 20px; width: 100%;">
                        <i class="fas fa-credit-card"></i> Checkout
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="notification" class="notification">Operation completed successfully!</div>

    <script>
        // Initialize date
        document.getElementById('current-date').textContent = new Date().toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        // Custom Local Storage Implementation
        const LocalStorage = {
            save: function(collectionName, data) {
                localStorage.setItem(collectionName, JSON.stringify(data));
            },
            
            load: function(collectionName) {
                const data = localStorage.getItem(collectionName);
                return data ? JSON.parse(data) : [];
            }
        };

        // Product Model
        const Product = Backbone.Model.extend({
            defaults: {
                id: null,
                name: '',
                price: 0,
                category: '',
                description: '',
                image: 'https://placehold.co/300x200?text=No+Image'
            }
        });

        // Product Collection
        const ProductCollection = Backbone.Collection.extend({
            model: Product,
            
            initialize: function() {
                this.loadFromStorage();
            },
            
            loadFromStorage: function() {
                const data = LocalStorage.load('products-backbone');
                this.add(data);
            },
            
            saveToStorage: function() {
                LocalStorage.save('products-backbone', this.toJSON());
            }
        });

        // Client Model
        const Client = Backbone.Model.extend({
            defaults: {
                id: null,
                name: '',
                card: '',
                cvv: '',
                address: ''
            }
        });

        // Client Collection
        const ClientCollection = Backbone.Collection.extend({
            model: Client,
            
            initialize: function() {
                this.loadFromStorage();
            },
            
            loadFromStorage: function() {
                const data = LocalStorage.load('clients-backbone');
                this.add(data);
            },
            
            saveToStorage: function() {
                LocalStorage.save('clients-backbone', this.toJSON());
            }
        });

        // Initialize collections
        const products = new ProductCollection();
        const clients = new ClientCollection();

        // Views
        const ProductView = Backbone.View.extend({
            tagName: 'div',
            className: 'product-card',
            
            template: _.template(`
                <div class="product-image">
                    <% if (image) { %>
                        <img src="<%= image %>" alt="<%= name %>" style="width:100%; height:100%; object-fit:cover;">
                    <% } else { %>
                        <i class="fas fa-image" style="font-size: 2rem;"></i>
                    <% } %>
                </div>
                <div class="product-info">
                    <h3 class="product-title"><%= name %></h3>
                    <div class="product-price">$<%= parseFloat(price).toFixed(2) %></div>
                    <p class="product-description"><%= description %></p>
                    <div class="product-actions">
                        <button class="btn btn-success edit-btn" data-id="<%= id %>"><i class="fas fa-edit"></i> Edit</button>
                        <button class="btn btn-danger delete-btn" data-id="<%= id %>"><i class="fas fa-trash"></i> Delete</button>
                    </div>
                </div>
            `),
            
            events: {
                'click .edit-btn': 'editProduct',
                'click .delete-btn': 'deleteProduct'
            },
            
            render: function() {
                this.$el.html(this.template(this.model.toJSON()));
                return this;
            },
            
            editProduct: function(e) {
                e.preventDefault();
                const id = $(e.currentTarget).data('id');
                const product = products.get(id);
                
                $('#product-name').val(product.get('name'));
                $('#product-price').val(product.get('price'));
                $('#product-category').val(product.get('category'));
                $('#product-description').val(product.get('description'));
                $('#product-image').val(product.get('image'));
                
                $('#add-product-btn').html('<i class="fas fa-sync-alt"></i> Update Product').off('click').click(function() {
                    updateProduct(id);
                });
            },
            
            deleteProduct: function(e) {
                e.preventDefault();
                const id = $(e.currentTarget).data('id');
                products.remove(id);
                products.saveToStorage();
                this.remove();
                showNotification('Product deleted successfully!', 'success');
            }
        });

        const ClientView = Backbone.View.extend({
            tagName: 'div',
            className: 'client-card',
            
            template: _.template(`
                <div class="client-info">
                    <h3><%= name %></h3>
                    <div class="client-details">
                        <p><i class="fas fa-credit-card"></i> Card: <%= card %></p>
                        <p><i class="fas fa-map-marker-alt"></i> <%= address %></p>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-success edit-btn" data-id="<%= id %>"><i class="fas fa-edit"></i></button>
                    <button class="btn btn-danger delete-btn" data-id="<%= id %>"><i class="fas fa-trash"></i></button>
                </div>
            `),
            
            events: {
                'click .edit-btn': 'editClient',
                'click .delete-btn': 'deleteClient'
            },
            
            render: function() {
                this.$el.html(this.template(this.model.toJSON()));
                return this;
            },
            
            editClient: function(e) {
                e.preventDefault();
                const id = $(e.currentTarget).data('id');
                const client = clients.get(id);
                
                $('#client-name').val(client.get('name'));
                $('#client-card').val(client.get('card'));
                $('#client-cvv').val(client.get('cvv'));
                $('#client-address').val(client.get('address'));
                
                $('#add-client-btn').html('<i class="fas fa-sync-alt"></i> Update Client').off('click').click(function() {
                    updateClient(id);
                });
            },
            
            deleteClient: function(e) {
                e.preventDefault();
                const id = $(e.currentTarget).data('id');
                clients.remove(id);
                clients.saveToStorage();
                this.remove();
                showNotification('Client deleted successfully!', 'success');
            }
        });

        // Cart functionality
        let cart = [];
        
        function addToCart(productId) {
            const product = products.get(productId);
            const existingItem = cart.find(item => item.id === productId);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    id: product.id,
                    name: product.get('name'),
                    price: parseFloat(product.get('price')),
                    image: product.get('image'),
                    quantity: 1
                });
            }
            
            updateCartDisplay();
            showNotification('Product added to cart!', 'success');
        }
        
        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartDisplay();
        }
        
        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartDisplay();
                }
            }
        }
        
        function updateCartDisplay() {
            const cartItemsContainer = $('#cart-items');
            const emptyCartMessage = $('#empty-cart-message');
            const totalAmount = $('#cart-total-amount');
            
            if (cart.length === 0) {
                cartItemsContainer.empty();
                emptyCartMessage.show();
                totalAmount.text('0.00');
                return;
            }
            
            emptyCartMessage.hide();
            cartItemsContainer.empty();
            
            let total = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const cartItem = $(`
                    <div class="cart-item">
                        <div class="cart-item-image">
                            <img src="${item.image}" alt="${item.name}" style="width:100%; height:100%; object-fit:cover;">
                        </div>
                        <div class="cart-item-info">
                            <div class="cart-item-title">${item.name}</div>
                            <div class="cart-item-price">$${item.price.toFixed(2)}</div>
                            <div class="cart-item-quantity">
                                <button class="quantity-btn decrease-qty" data-id="${item.id}">-</button>
                                <span class="quantity-value">${item.quantity}</span>
                                <button class="quantity-btn increase-qty" data-id="${item.id}">+</button>
                            </div>
                        </div>
                        <button class="btn btn-danger remove-item" data-id="${item.id}" style="padding: 5px 10px;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `);
                
                cartItemsContainer.append(cartItem);
            });
            
            totalAmount.text(total.toFixed(2));
            
            // Bind events for cart items
            $('.remove-item').click(function() {
                const id = $(this).data('id');
                removeFromCart(id);
            });
            
            $('.decrease-qty').click(function() {
                const id = $(this).data('id');
                updateQuantity(id, -1);
            });
            
            $('.increase-qty').click(function() {
                const id = $(this).data('id');
                updateQuantity(id, 1);
            });
        }
        
        function checkout() {
            if (cart.length === 0) {
                showNotification('Your cart is empty!', 'error');
                return;
            }
            
            const clientId = $('#client-select').val();
            if (!clientId) {
                showNotification('Please select a client!', 'error');
                return;
            }
            
            const client = clients.get(clientId);
            if (!client) {
                showNotification('Invalid client selected!', 'error');
                return;
            }
            
            // In a real app, this would process the payment
            cart = [];
            updateCartDisplay();
            showNotification(`Order placed successfully for ${client.get('name')}!`, 'success');
        }
        
        function addProduct() {
            const name = $('#product-name').val().trim();
            const price = parseFloat($('#product-price').val());
            const category = $('#product-category').val();
            const description = $('#product-description').val().trim();
            const image = $('#product-image').val().trim();
            
            if (!name || isNaN(price) || price <= 0 || !category || !description) {
                showNotification('Please fill in all required fields correctly!', 'error');
                return;
            }
            
            const product = new Product({
                name: name,
                price: price,
                category: category,
                description: description,
                image: image || 'https://placehold.co/300x200?text=No+Image'
            });
            
            products.add(product);
            products.saveToStorage();
            
            renderProducts();
            resetProductForm();
            showNotification('Product added successfully!', 'success');
        }
        
        function updateProduct(id) {
            const product = products.get(id);
            const name = $('#product-name').val().trim();
            const price = parseFloat($('#product-price').val());
            const category = $('#product-category').val();
            const description = $('#product-description').val().trim();
            const image = $('#product-image').val().trim();
            
            if (!name || isNaN(price) || price <= 0 || !category || !description) {
                showNotification('Please fill in all required fields correctly!', 'error');
                return;
            }
            
            product.set({
                name: name,
                price: price,
                category: category,
                description: description,
                image: image || 'https://placehold.co/300x200?text=No+Image'
            });
            
            products.saveToStorage();
            
            renderProducts();
            resetProductForm();
            $('#add-product-btn').html('<i class="fas fa-plus"></i> Add Product').off('click').click(addProduct);
            showNotification('Product updated successfully!', 'success');
        }
        
        function resetProductForm() {
            $('#product-name').val('');
            $('#product-price').val('');
            $('#product-category').val('');
            $('#product-description').val('');
            $('#product-image').val('');
        }
        
        function addClient() {
            const name = $('#client-name').val().trim();
            const card = $('#client-card').val().trim();
            const cvv = $('#client-cvv').val().trim();
            const address = $('#client-address').val().trim();
            
            if (!name || !card || !cvv || !address) {
                showNotification('Please fill in all required fields!', 'error');
                return;
            }
            
            // Basic validation for card number (16 digits)
            if (!/^\d{16}$/.test(card.replace(/\s/g, ''))) {
                showNotification('Please enter a valid 16-digit card number!', 'error');
                return;
            }
            
            // Basic validation for CVV (3 digits)
            if (!/^\d{3}$/.test(cvv)) {
                showNotification('Please enter a valid 3-digit CVV!', 'error');
                return;
            }
            
            const client = new Client({
                name: name,
                card: card,
                cvv: cvv,
                address: address
            });
            
            clients.add(client);
            clients.saveToStorage();
            
            renderClients();
            resetClientForm();
            showNotification('Client added successfully!', 'success');
        }
        
        function updateClient(id) {
            const client = clients.get(id);
            const name = $('#client-name').val().trim();
            const card = $('#client-card').val().trim();
            const cvv = $('#client-cvv').val().trim();
            const address = $('#client-address').val().trim();
            
            if (!name || !card || !cvv || !address) {
                showNotification('Please fill in all required fields!', 'error');
                return;
            }
            
            // Basic validation for card number (16 digits)
            if (!/^\d{16}$/.test(card.replace(/\s/g, ''))) {
                showNotification('Please enter a valid 16-digit card number!', 'error');
                return;
            }
            
            // Basic validation for CVV (3 digits)
            if (!/^\d{3}$/.test(cvv)) {
                showNotification('Please enter a valid 3-digit CVV!', 'error');
                return;
            }
            
            client.set({
                name: name,
                card: card,
                cvv: cvv,
                address: address
            });
            
            clients.saveToStorage();
            
            renderClients();
            resetClientForm();
            $('#add-client-btn').html('<i class="fas fa-user-plus"></i> Add Client').off('click').click(addClient);
            showNotification('Client updated successfully!', 'success');
        }
        
        function resetClientForm() {
            $('#client-name').val('');
            $('#client-card').val('');
            $('#client-cvv').val('');
            $('#client-address').val('');
        }
        
        function renderProducts() {
            const productsContainer = $('#products-container');
            const shopProductsContainer = $('#shop-products-container');
            
            productsContainer.empty();
            shopProductsContainer.empty();
            
            products.each(function(product) {
                const productView = new ProductView({ model: product });
                productsContainer.append(productView.render().el);
                
                // Also add to shop products container
                const shopProductView = new ProductView({ model: product });
                shopProductView.$el.find('.product-actions').html(`
                    <button class="btn btn-success add-to-cart" data-id="${product.id}">
                        <i class="fas fa-cart-plus"></i> Add to Cart
                    </button>
                `);
                shopProductView.$el.find('.add-to-cart').click(function() {
                    addToCart($(this).data('id'));
                });
                
                shopProductsContainer.append(shopProductView.render().el);
            });
        }
        
        function renderClients() {
            const clientsContainer = $('#clients-container');
            const clientSelect = $('#client-select');
            
            clientsContainer.empty();
            clientSelect.empty();
            clientSelect.append('<option value="">Choose a client</option>');
            
            clients.each(function(client) {
                const clientView = new ClientView({ model: client });
                clientsContainer.append(clientView.render().el);
                
                // Add to client selection dropdown
                clientSelect.append(`<option value="${client.id}">${client.get('name')}</option>`);
            });
        }
        
        function showNotification(message, type = 'success') {
            const notification = $('#notification');
            notification.removeClass('error').addClass(type);
            notification.text(message);
            notification.addClass('show');
            
            setTimeout(() => {
                notification.removeClass('show');
            }, 3000);
        }
        
        // Initialize the app
        $(document).ready(function() {
            // Tab switching
            $('.tab').click(function() {
                const tabId = $(this).data('tab');
                
                // Update active tab
                $('.tab').removeClass('active');
                $(this).addClass('active');
                
                // Show active content
                $('.tab-content').removeClass('active');
                $(`#${tabId}-tab`).addClass('active');
            });
            
            // Event listeners
            $('#add-product-btn').click(addProduct);
            $('#add-client-btn').click(addClient);
            $('#checkout-btn').click(checkout);
            
            // Render initial data
            renderProducts();
            renderClients();
            
            // If no products exist, add some sample data
            if (products.length === 0) {
                const sampleProducts = [
                    { name: 'Wireless Headphones', price: 89.99, category: 'Electronics', description: 'High-quality wireless headphones with noise cancellation', image: 'https://placehold.co/300x200?text=Headphones' },
                    { name: 'Cotton T-Shirt', price: 19.99, category: 'Clothing', description: 'Comfortable 100% cotton t-shirt in various colors', image: 'https://placehold.co/300x200?text=T-Shirt' },
                    { name: 'Coffee Maker', price: 49.95, category: 'Home & Kitchen', description: 'Programmable coffee maker with thermal carafe', image: 'https://placehold.co/300x200?text=Coffee+Maker' }
                ];
                
                sampleProducts.forEach(productData => {
                    const product = new Product(productData);
                    products.add(product);
                });
                
                products.saveToStorage();
                renderProducts();
            }
            
            // If no clients exist, add a sample client
            if (clients.length === 0) {
                const sampleClient = new Client({
                    name: 'John Doe',
                    card: '1234 5678 9012 3456',
                    cvv: '123',
                    address: '123 Main St, New York, NY 10001'
                });
                
                clients.add(sampleClient);
                clients.saveToStorage();
                renderClients();
            }
        });
    </script>
</body>
</html>